{% extends 'base.html' %}
{% block title %}{{ category.name }} ‚Äî Ovoz{% endblock %}

{% block extra_css %}
.cat-hero {
    padding: 60px 5% 40px;
    border-bottom: 1px solid var(--border);
}
.cat-badge {
    display: inline-block;
    width: 14px; height: 14px;
    border-radius: 50%;
    background: {{ category.color }};
    margin-right: 10px;
    vertical-align: middle;
}
.cat-hero h1 {
    font-family: var(--font-display);
    font-size: clamp(2rem, 5vw, 3.5rem);
    font-weight: 900; letter-spacing: -1.5px;
    color: var(--white);
}
.cat-hero h1 span { color: {{ category.color }}; }
.cat-count { color: var(--text-muted); margin-top: 8px; }

.posts-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 24px; padding: 40px 5%; }
.post-card { background: var(--surface); border: 1px solid var(--border); border-radius: 14px; overflow: hidden; transition: transform 0.2s, border-color 0.2s; }
.post-card:hover { transform: translateY(-4px); border-color: {{ category.color }}; }
.card-img { height: 180px; overflow: hidden; background: var(--surface2); }
.card-img img { width:100%;height:100%;object-fit:cover;transition:transform 0.4s; }
.post-card:hover .card-img img { transform: scale(1.05); }
.no-img { width:100%;height:100%;display:flex;align-items:center;justify-content:center;font-size:2.5rem; background: linear-gradient(135deg, var(--surface2), #1a1a2e); }
.card-body { padding: 20px; }
.card-title { font-family: var(--font-display); font-size: 1.1rem; font-weight: 700; color: var(--white); text-decoration: none; display: block; line-height: 1.3; }
.card-title:hover { color: {{ category.color }}; }
.card-excerpt { color: var(--text-muted); font-size: 0.85rem; margin-top: 8px; line-height: 1.6; }
.card-footer { display: flex; justify-content: space-between; align-items: center; margin-top: 14px; padding-top: 12px; border-top: 1px solid var(--border); font-size: 0.8rem; color: var(--text-muted); }
{% endblock %}

{% block content %}
<div class="cat-hero container">
    <h1><span class="cat-badge"></span><span>{{ category.name }}</span></h1>
    {% if category.description %}<p class="cat-count">{{ category.description }}</p>{% endif %}
    <p class="cat-count">{{ paginator.count }} ta post</p>
</div>

{% if posts %}
<div class="container">
    <div class="posts-grid" style="padding-left:0;padding-right:0;">
        {% for post in posts %}
        <article class="post-card">
            <div class="card-img">
                {% if post.cover_image %}<img src="{{ post.cover_image.url }}" alt="{{ post.title }}">
                {% else %}<div class="no-img">üìù</div>{% endif %}
            </div>
            <div class="card-body">
                <a class="card-title" href="{{ post.get_absolute_url }}">{{ post.title }}</a>
                <p class="card-excerpt">{{ post.excerpt|truncatechars:100 }}</p>
                <div class="card-footer">
                    <span>{{ post.author.username }} ¬∑ {{ post.created_at|date:"d M Y" }}</span>
                    <span>‚ù§Ô∏è {{ post.like_count }}</span>
                </div>
            </div>
        </article>
        {% endfor %}
    </div>
</div>
{% else %}
<div style="text-align:center;padding:80px 5%;color:var(--text-muted);">
    <p style="font-size:3rem;">üìÇ</p>
    <p>Bu kategoriyada hali postlar yo'q.</p>
    {% if user.is_authenticated %}
    <a href="{% url 'post_create' %}" class="btn btn-primary" style="margin-top:20px;">Birinchi post yozing</a>
    {% endif %}
</div>
{% endif %}
{% endblock %}